<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<script src="js/flexible_css.debug.js"></script>
		<script src="js/flexible.debug.js"></script>
		<!--<link href="css/mui.min.css" rel="stylesheet" />-->
		<link href="css/style.css" rel="stylesheet" />
		<title></title>
	</head>

	<body>
		<div id="index-bar-tab">
			<div id="home" class="index-tab-item index-tab-active" data-href="webview-home.html">
				<span class="icon-index icon-index-home"></span>				
				<span class="icon-label">首页</span>
			</div>
			<div id="comu" class="index-tab-item" data-href="webview-comu.html">
				<span class="icon-index icon-index-comu"></span>				
				<span class="icon-label">社区</span>
			</div>
			<div id="map" class="index-tab-item" data-href="webview-nav.html">
				<span class="icon-index icon-index-nav"></span>				
				<span class="icon-label">地图</span>
			</div>
			<div id="my" class="index-tab-item" data-href="webview-my.html">
				<span class="icon-index icon-index-info"></span>
				<span class="icon-label">我的</span>
			</div>
		</div>

		<script src="js/mui.min.js"></script>
		<script src="js/md5.min.js"></script>
		<script src="js/public.js"></script>
		<script>
			mui.init();
			//初始化
			
			var subpages = ['webview-home.html', 'webview-comu.html', 'webview-nav.html', 'webview-my.html'];
			//默认激活标签
			var activeTab = "webview-home.html";
			mui.plusReady(function() {
				//仅支持竖屏显示
				plus.screen.lockOrientation("portrait-primary");
				//更改系统状态栏颜色
				//				plus.navigator.setStatusBarBackground("#83C347");
				//首页返回键处理
				//处理逻辑：1秒内，连续两次按返回键，则退出应用；
//				var first = null;
//				mui.back = function() {
//					if (!first) {
//						first = new Date().getTime();
//						mui.toast('再按一次退出应用');
//						setTimeout(function() {
//							first = null;
//						}, 2000);
//					} else {
//						if (new Date().getTime() - first < 2000) {
//							plus.runtime.quit();
//						}
//					}
//				};
				//
				var aniShow = {};
				var self = plus.webview.currentWebview();
				for (var i = 0; i < subpages.length; i++) {
					var sub;
					if (i == subpages.length - 1) {
						sub = plus.webview.create(subpages[i], subpages[i], fnSetSubpageStyle(0, 100));
						sub.onloaded = function() {
							plus.navigator.closeSplashscreen();
							var webHead = mui.preload({
								url: "webview-header.html",
								id: "webview-header",
								styles: fnSetSubpageStyle(0, 0)
							});
							var tradeHead = mui.preload({
								url: "webview-trade-header.html",
								id: "webview-trade-header",
								styles: fnSetSubpageStyle(0, 0)
							});
							var shophead = mui.preload({
								url: "webview-shop-header.html",
								id: "webview-shop-header",
								styles: fnSetSubpageStyle(0, 0)
							});
							
							var delayTime = mui.os.ios ? 100 : 1000;
							setTimeout(function() {
								plus.navigator.closeSplashscreen();
							}, delayTime);     
						}
					} else {
						sub = plus.webview.create(subpages[i], subpages[i], fnSetSubpageStyle(0, 100));
					}
					//显示第一个
					if (i > 0) {
						sub.hide();
					} else {
						sub.show();
					}
				}
				// 选项卡点击事件
				mui("#index-bar-tab").on("tap", ".index-tab-item", function(e) {
					var targetTab = this.getAttribute("data-href");
					if (targetTab == activeTab) {
						return;
					}					
document.querySelector(".index-tab-active").classList.remove("index-tab-active");
					this.classList.add("index-tab-active");
					plus.webview.hide(activeTab, "none");
					plus.webview.show(targetTab, "none");
					activeTab = targetTab;
				});
			});
		</script>
	</body>

</html>
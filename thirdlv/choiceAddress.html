<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>选择所在城市</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<!--标准mui.css-->
		<link rel="stylesheet" href="../css/mui.min.css">
		<style>
			.mui-row.mui-fullscreen>[class*="mui-col-"] {
				height: 100%;
			}
			.mui-col-xs-3,
			.mui-control-content {
				overflow-y: auto;
				height: 100%;
			}
			.mui-segmented-control .mui-control-item {
				line-height: 50px;
				width: 100%;
			}
			.mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active {
				background-color: #fff;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<h1 class="mui-title" id="result">未选择</h1>
		</header>
		<div class="mui-content mui-row mui-fullscreen">
			<div class="mui-col-xs-3">
				<div id="segmentedControls" class="mui-segmented-control mui-segmented-control-inverted mui-segmented-control-vertical">
				</div>
			</div>
			<div id="segmentedControlContents" class="mui-col-xs-9" style="border-left: 1px solid #c8c7cc;">
				<div id="item1" class="mui-control-content mui-active">
				</div>
				<div id="item2" class="mui-control-content">
				</div>
				<div id="item3" class="mui-control-content">
				</div>
			</div>
		</div>
		<div class="my-toast" id="myToast">
			<span class="my-toast-content"></span>
		</div>
		<script type="text/javascript" src="../data/city.js" ></script>
		<script src="../js/mui.min.js"></script>
		<script>
			mui.init({
//				swipeBack: true //启用右滑关闭功能
			});
			var controls = document.getElementById("segmentedControls");
			var contents = document.getElementById("segmentedControlContents");
			var html = [];
			var i = 1, j = 1;
			var cityNum = 0;
			var cityName = "";
				
			for (var key in province) {
				console.log(key);
				html.push('<a class="mui-control-item" href="#content' + key + '">' + province[key] + '</a>');
				i++;
			}
			controls.innerHTML = html.join('');
			
			html = [];
			for (var key2 in city) {
				html.push('<div id="content' + key2 + '" class="mui-control-content"><ul class="mui-table-view">');
				for (var key3 in city[key2]) {
					html.push('<li class="mui-table-view-cell" data-num='+ key3 +'  onclick="getNum(this);">' + city[key2][key3] + '</li>');
				}
				html.push('</ul></div>');
			}

			contents.innerHTML = html.join('');
			 //默认选中第一个
			controls.querySelector('.mui-control-item').classList.add('mui-active');
			contents.querySelector('.mui-control-content').classList.add('mui-active');
			
			
			function getNum(obj) {				
				document.getElementById("result").innerText = "已选择 :    " + obj.innerText;
				cityNum = obj.getAttribute("data-num");
				cityName = obj.innerText;
			}
			
			window.addEventListener("saveCity", function() {		
				if (cityName.length == 0) {
					alert("请选择城市");
					return;
				}
				plus.storage.setItem("cityNum", cityNum);
				plus.storage.setItem("cityName", cityName);
				mui.fire(plus.webview.getWebviewById("editAddress.html"), "changeAddress", {});			
				window.setTimeout(function() {
					plus.webview.getWebviewById("webview-header").hide();				
				}, 100);				
			});
		</script>

	</body>

</html>
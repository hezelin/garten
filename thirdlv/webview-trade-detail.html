<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>商品详情</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<script src="../js/flexible_css.debug.js"></script>
		<script src="../js/flexible.debug.js"></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link href="../css/style.css" rel="stylesheet" />
		<style>
			html,
			body {
				background-color: #efeff4;
			}
			
			[v-cloak] {
				display: none;
			}
			
			.scroll-hide {
				display: none;
			}
			
			.scroll-active {
				display: block;
			}
			
			.farm-display-none {
				display: none;
			}
			/*商品介绍*/
			
			#scroll2 {
				background-color: #FFFFFF;
			}
			
			#introduceScroll {
				width: 96%;
				margin-left: 2%;
			}
			
			#introduceScroll img {
				width: 100% !important;
				height: auto !important;
				display: block;
			}
		</style>
	</head>

	<body>
		<div class="header-control header-control-whiteBold">
			<div class="header-control-left-btn  mui-action-back">
				<span class="black-arrow-big-span header-control-left-btn-span"></span>
			</div>
			<div class="trade-header-container">
				<span class="trade-header-nav trade-header-nav-active" id="initScroll" data-first="true" data-container="detailScroll" data-scroll="#scroll1">商品</span>
				<span class="trade-header-nav" data-first="true" data-container="introduceScroll" data-scroll="#scroll2">详情</span>
				<!--<span class="trade-header-nav" data-url="/thirdlv/webview-home-rent-comment.html">评论</span>-->
			</div>
			<div class="header-control-right-btn">
				<span class="header-control-right-btn-span shop-car-black-span"></span>
			</div>
		</div>
		<div id="scroll1" class="mui-scroll-wrapper trade-scroll-position scroll-hide scroll-active">
			<div class="mui-scroll" id="detailScroll" v-clock>
				<div id="slider" class="mui-slider">
					<div class="mui-slider-group mui-slider-loop">
						<!-- (循环轮播：第一个节点是最后一张图片) 节点数量等于轮播图片+1-->
						<div class="mui-slider-item mui-slider-item-duplicate">
							<a href="#">
								<!--轮播图尺寸规定为750*490-->
								<span class="trade-span-cover-slider" style="background: url({{images[images.length - 1]}}); background-size: cover;background-position: center;"></span>
							</a>
						</div>
						<div class="mui-slider-item" v-for="img in images">
							<a href="#">
								<span class="trade-span-cover-slider" style="background: url({{img}}); background-size: cover;background-position: center;"></span>
							</a>
						</div>
						<!--额外增加的一个节点(最后一个节点与“原”第一张图片相同)-->
						<div class="mui-slider-item mui-slider-item-duplicate">
							<a href="#">
								<span class="trade-span-cover-slider" style="background: url({{images[0]}}); background-size: cover;background-position: center;"></span>
							</a>
						</div>
					</div>
					<div class="pageIndex">
					</div>
					<div class="mui-slider-indicator mui-text-center" style="display: none;">
						<!--对应图片个数-->
						<div class="mui-indicator mui-active home-slider-text-size"></div>
						<div class="mui-indicator home-slider-text-size" v-for="n in images.length" v-if="n > 0"></div>
					</div>
				</div>
				<div class="detail-price">
					<span class="home-rent-detail-name">
						{{title}}
					</span>
					<span class="home-rent-detail-money">
						<em>&yen;&nbsp;&nbsp;</em><label>{{price}}-{{high_price}}</label>
					</span>
				</div>
				<div class="home-rent-detail-suit">
					<div class="home-rent-detail-suit-item {{$index < params.length - 1 ? 'home-rent-detail-suit-item-border' : ''}}" v-for="item in params">
						<div class="home-rent-detail-suit-item-left">{{item.name}}</div>
						<div class="home-rent-detail-suit-item-right">{{item.value}}</div>
					</div>
				</div>
				<div class="home-rent-detail-shop" id="openShop" shop-id="{{shop_id}}" style="margin-bottom: 10px;">
					<div class="home-rent-detail-shop-left">

						<span class="home-rent-detail-shop-logo" style="background: url({{shop_image}}); background-size: cover; background-position: center"></span>
					</div>
					<div class="home-rent-detail-shop-middle">
						<span class="home-rent-detail-shop-name">{{shop_name}}</span>
					</div>
					<div class="home-rent-detail-shop-right">
						<span class="mui-icon mui-icon-forward"></span>
					</div>
				</div>
				<div class="home-rent-detail-shop-detail" style="display: none;">
					<div class="home-rent-detail-shop-detail-btn">
						<div class="home-rent-detail-shop-detail-content">
							<span class="home-rent-detail-shop-detail-content-num">{{shop_item_num}}</span>
							<div>
								<span class="shop-wares-span"></span>
								<span class="home-rent-detail-shop-detail-content-name">商品</span>
							</div>
						</div>
					</div>
					<div class="home-rent-detail-shop-detail-btn">
						<div class="home-rent-detail-shop-detail-content">
							<span class="home-rent-detail-shop-detail-content-num">{{shop_evaluate_num}}</span>
							<div>
								<span class="shop-wares-assess-span"></span>
								<span class="home-rent-detail-shop-detail-content-name">评价</span>
							</div>
						</div>
					</div>
					<div class="home-rent-detail-shop-detail-btn">
						<div class="home-rent-detail-shop-detail-content home-rent-detail-shop-detail-border-none">
							<span class="home-rent-detail-shop-detail-content-num">{{shop_share_num}}</span>
							<div>
								<span class="shop-wares-share-span"></span>
								<span class="home-rent-detail-shop-detail-content-name">分享</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="scroll2" class="mui-scroll-wrapper trade-scroll-position scroll-hide">
			<div class="mui-scroll" id="introduceScroll">
			</div>
		</div>
		<!--下面是共用元素-->
		<!--底部栏-->
		<div class="trade-foot-control">
			<div class="trade-foot-control-small-btn line-weight-half-top" id="contactSale">
				<span class="trade-foot-control-small-btn-logo" style="background: url(../img/custom-service.png); background-size: cover;"></span>
				<span class="trade-foot-control-small-btn-title">客服</span>
			</div>
			<div class="trade-foot-control-small-btn line-weight-half-top" id="openShop2">
				<span class="trade-foot-control-small-btn-logo" style="background: url(../img/shop.png); background-size: cover;"></span>
				<span class="trade-foot-control-small-btn-title">店铺</span>
			</div>
			<div class="trade-foot-control-small-btn line-weight-half-top" id="addCollect" data-isCollect="false">
				<span class="trade-foot-control-small-btn-logo" style="background: url(../img/collect.png); background-size: cover;"></span>
				<span class="trade-foot-control-small-btn-title">收藏</span>
			</div>
			<div class="trade-foot-control-btn" id="addToShopCar">
				<span class="trade-foot-control-name">加入购物车</span>
			</div>
			<div class="trade-foot-control-btn bg-color-green" id="buyNow">
				<span class="trade-foot-control-name">立即购买</span>
			</div>
		</div>
		<!--购买div，动画形式弹出-->
		<div id="buyDiv" class="mutual-div">
			<div class="buyDiv-title">
				<span class="buyDiv-title-img" style="background: url({{images[0]}}); background-size: cover; background-position: center;"></span>
				<span class="buyDiv-message">					
					<span class="home-rent-detail-money" >
						<em>&yen;&nbsp;&nbsp;</em><label id="buyDiv-message-price">{{price}}-{{high_price}}</label>
					</span>
				<label class="buyDiv-message-item" id="buyDiv-message-choose" data-id="">请选择&nbsp;套餐</label>
				<label class="buyDiv-message-item" id="buyDiv-message-residue"></label>
				</span>
				<span id="buyDivClose"></span>
			</div>
			<div class="buyDiv-item">
				<label class="buyDiv-item-title">
					选择套餐
				</label>
				<div class="buyDiv-item-group">
					<span class="buyDiv-items {{(parseInt(item.repertory) <= 0) ? 'buyDiv-items-disabled' : ''}}" v-on:tap="setBuyMessage" v-for="item in standard_price_num" data-itemID="{{item.id}}" data-price="{{item.price}}" data-residue="{{item.repertory}}">{{item.label}}</span>
				</div>
			</div>
			<div class="buyDiv-count">
				<label class="buyDiv-count-title">
					购买数量
				</label>
				<div class="buyDiv-count-right">
					<div class="num-choice">
						<span class="num-choice-left num-choice-item">-</span>
						<span class="num-choice-mid num-choice-item">1</span>
						<span class="num-choice-right num-choice-item">+</span>
					</div>
				</div>
			</div>
			<div class="buyDiv-btn">
				<button id="btnAdd" class="buyDiv-bottom-btn" style="display: none;">加入购物车</button>
				<button id="btnBuy" class="buyDiv-bottom-btn" style="display: none;">完成</button>
			</div>
		</div>
		<div class="my-toast" id="myToast">
			<span class="my-toast-content"></span>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/md5.min.js"></script>
		<script src="../js/public.js"></script>
		<script src="../js/vue.min.js"></script>
		<script>
			// 系统页面初始化
			mui.init();
			// 阻尼系数
			var deceleration = mui.os.ios ? 0.003 : 0.0009;
			mui('.mui-scroll-wrapper').scroll({
				bounce: false,
				indicators: false, // 是否显示滚动条
				deceleration: deceleration
			});
			// 商品id，页面打开时赋值
			var item_id = "";
			// 商店名，获取数据时赋值
			var shopName = "";
			// 商店id,获取数据时赋值
			var shopId = "";
			// 商店图,获取数据时赋值
			var shopImg = "";
			// 商品名,获取数据时赋值
			var itemName = "";
			// 商品图,获取数据时赋值
			var itemImg = "";
			var old_back = mui.back;
			mui.back = function() {
				if (mui.os.plus) {
					var w = plus.webview.currentWebview();
					if (w.id == "webview-trade-detail.html") {
						var w2 = plus.webview.getWebviewById("../secondlv/webview-my-shopcar.html");
						mui.fire(w2, "refreshShopCar", {});
					}
				}
				old_back();
			};
			var detailVue = new Vue({
				el: "#detailScroll"
			});

			function initSwitchTab() {
				mui('.trade-header-container').on('tap', '.trade-header-nav', function() {
					// 获取数据
					if (this.getAttribute("data-first") == "true") {
						// 如果这个tab是第一点击，那么处理它
						handle(this);
					}
					var _active = document.querySelector(".trade-header-nav-active").getAttribute("data-container"); // 当前活跃						
					var _new = this.getAttribute("data-container"); // 目标
					var _aw = plus.webview.getWebviewById(_active);
					var _nw = plus.webview.getWebviewById(_new);
					if (_aw) {
						_aw.hide()
					}
					if (_nw) {
						_nw.show();
					}
					// 更换滚动区域
					var elem = document.querySelector(".scroll-active").classList.remove("scroll-active");
					document.querySelector(this.getAttribute("data-scroll")).classList.add("scroll-active");
					// 更改按钮状态
					if (!this.classList.contains("trade-header-nav-active")) {
						document.querySelector(".trade-header-nav-active").classList.remove("trade-header-nav-active");
						this.classList.add("trade-header-nav-active");
					}
				});
			};

			function initBuyGroup(resData) { // 购买-动画
				new Vue({
					el: "#buyDiv",
					data: resData,
					methods: {
						// 点击套餐时
						setBuyMessage: function(event) {
							// 选择套餐
							var itemElem = event.currentTarget;
							var oldElem = document.querySelector(".buyDiv-items-active");
							if (oldElem) {
								oldElem.classList.remove("buyDiv-items-active");
							}
							itemElem.classList.add("buyDiv-items-active");
							document.getElementById("buyDiv-message-choose").innerText = "已选：" + itemElem.innerText;
							document.getElementById("buyDiv-message-choose").setAttribute("data-id", itemElem.getAttribute("data-itemID"));
							document.getElementById("buyDiv-message-price").innerText = itemElem.getAttribute("data-price");
							var residue = itemElem.getAttribute("data-residue");
							if (residue == '') {
								console.log("无限");
							} else if (parseInt(residue) <= 0) {
								document.getElementById("buyDiv-message-residue").innerText = "商品数量不足！";
							} else {
								document.getElementById("buyDiv-message-residue").innerText = "剩余：" + itemElem.getAttribute("data-residue");
							}
						}
					}
				})
				document.querySelector("#addToShopCar").addEventListener("tap", function() {
					mui.trigger(document.getElementById("initScroll"), "tap");
					var id = "#buyDiv";
					document.getElementById("btnAdd").style.display = "inline-block";
					document.getElementById("btnBuy").style.display = "none";
					fnOpenTargetDiv(id);
				});
				document.querySelector("#buyNow").addEventListener("tap", function() {
					mui.trigger(document.getElementById("initScroll"), "tap");
					var id = "#buyDiv";
					document.getElementById("btnAdd").style.display = "none";
					document.getElementById("btnBuy").style.display = "inline-block";
					fnOpenTargetDiv(id);
				});
				document.querySelector("#buyDivClose").addEventListener("tap", function() {
					var id = "#buyDiv";
					fnCloseShade(id);
				});
				// 购买-动画end
				// 数字选择器
				var chocieMID = document.querySelector(".num-choice-mid");
				var choicePrice = document.querySelector(".buyDiv-money-count");
				document.querySelector(".num-choice-left").addEventListener("tap", function() {
					var val = chocieMID.innerText;
					if (val == "1") {
						return;
					}
					chocieMID.innerText = parseInt(val) - 1;
				});
				document.querySelector(".num-choice-right").addEventListener("tap", function() {
					chocieMID.innerText = parseInt(chocieMID.innerText) + 1;
				});
				// 数字选择器end	
			};

			function initSlider() {
				document.querySelector(".pageIndex").innerText = 1 + "/" + (document.querySelectorAll(".mui-slider-item").length - 2);
				mui(".mui-slider").on("dragend", ".mui-slider-group", function() {
					setTimeout(function() {
						var nodeElem = document.querySelectorAll(".mui-indicator");
						var count = 1;
						for (var i = 0; i < nodeElem.length; i++) {
							if (nodeElem[i].classList.contains("mui-active")) {
								break;
							}
							count++;
						}
						document.querySelector(".pageIndex").innerHTML = count + "/" + nodeElem.length;
					}, 600);
				});
			}

			function handle(btn) {
				var tabText = btn.innerText;
				switch (tabText) {
					case "商品":
						handleDetail(btn);
						break;
					case "详情":
						handleIntroduce(btn);
						break;
					case "评论":
						handleComment(btn);
						break;
				}
			}

			function handleDetail(btn) {
				var containerID = btn.getAttribute("data-container");
				var URL = "http://farm.rrzuji.com/v1/items/" + item_id + "?fields=id,shop_id,shop_name,shop_image,shop_item_num,shop_evaluate_num,shop_share_num,title,price,high_price,images,params,standard_price_num,dispatch&" + fnCreateSign();
				mui.ajax(URL, {
					type: "GET",
					dataType: "JSON",
					timeout: 15000,
					success: function(res) {
						console.log("商品详情" + res);
						res = JSON.parse(res);
						if (res.success) {
							btn.setAttribute("data-first", "false");
							shopId = res.data.shop_id;
							shopName = res.data.shop_name;
							shopImg = res.data.shop_image;
							itemName = res.data.title;
							itemImg = res.data.images[0];
							detailVue.$data = res.data;
							detailVue.$nextTick(function() {
								// DOM 现在更新了
								initSlider();
								initBuyGroup(res.data);
							});
						}
					},
					error: function(xhr, type, errorThrown) {
						ajaxError(xhr);
						mui.toast("加载失败，请检查您的网络");
					}
				})
			}

			function handleIntroduce(btn) {
				if (NetWorkStatus()) {
					return;
				}
				var containerID = btn.getAttribute("data-container");
				var URL = "http://farm.rrzuji.com/v1/items/" + item_id + "?fields=introduce&" + fnCreateSign();
				mui.ajax(URL, {
					type: "GET",
					dataType: "JSON",
					timeout: 15000,
					success: function(res) {
						console.log("详情介绍" + res);
						res = JSON.parse(res);
						if (res.success) {
							btn.setAttribute("data-first", "false");
							//							document.querySelector("#introduceScroll").innerHTML = res.data.introduce;
							var w = plus.webview.create("webview-trade-detail-introduce.html", containerID, fnSetSubpageStyle(99, 100), {htmlData: res.data.introduce});
							plus.webview.currentWebview().append(w);
						}
					},
					error: function(xhr, type, errorThrown) {
						ajaxError(xhr);
						mui.toast("加载失败，请检查您的网络");
					}
				})
				//				var containerID = btn.getAttribute("data-container");
				//				var URL = "http://farm.rrzuji.com/v1/items/" + item_id + "?fields=introduce&" + fnCreateSign();
				//				mui.ajax(URL, {
				//					type: "GET",
				//					dataType: "JSON",
				//					timeout: 15000,
				//					success: function(res) {
				//						console.log("详情介绍" + res);
				//						res = JSON.parse(res);
				//						if (res.success) {
				//							btn.setAttribute("data-first", "false");
				//							document.querySelector("#introduceScroll").innerHTML = res.data.introduce;
				//						}
				//					},
				//					error: function(xhr, type, errorThrown) {
				//						ajaxError(xhr);
				//						mui.toast("加载失败，请检查您的网络");
				//					}
				//				})
			}

			function handleComment(btn) {}
			// 打开商店页面
			document.getElementById("openShop").addEventListener("tap", function() {
				fnOpenShop();
			});
			document.getElementById("openShop2").addEventListener("tap", function() {
				fnOpenShop();
			});

			function fnOpenShop() {
				mui.openWindow({
					url: "webview-shop.html",
					styles: fnSetSubpageStyle(0, 0),
					createNew: false,
					extras: {
						shopId: shopId
					},
					show: {
						autoShow: true,
						aniShow: "pop-in",
						duration: 300
					},
					waiting: {
						autoShow: true
					}
				});
			}
			// 添加到收藏
			document.getElementById("addCollect").addEventListener("tap", function() {
				if (NetWorkStatus()) {
					return;
				}
				if (!userLoginStatus()) {
					openLogin(this, true);
					return;
				}
				if (this.getAttribute("data-send")) {
					return;
				}
				this.setAttribute("data-send", "true");
				if (this.getAttribute("data-isCollect") == "false") {
					handleCollect(this);
				} else {
					handleCancelCollect(this);
				}
			});

			function handleCollect(thisBtn) {
				var userId = plus.storage.getItem("userID");
				var token = plus.storage.getItem("tokenValue");
				var URL = "http://farm.rrzuji.com/v1/collect/create?" + fnCreateSign() + "&access-token=" + token;
				mui.ajax(URL, {
					type: "POST",
					dataType: "JSON",
					data: {
						user_id: userId,
						shop_id: shopId,
						item_id: item_id,
						shop_name: shopName
					},
					success: function(res) {
						console.log(res);
						res = JSON.parse(res);
						if (res.success) {
							console.log("收藏成功");
							thisBtn.removeAttribute("data-send");
							thisBtn.setAttribute("data-isCollect", "true");
							thisBtn.setAttribute("data-list-id", res.data.id);
							var elem = thisBtn.querySelector(".trade-foot-control-small-btn-logo");
							elem.style.background = "url(../img/isCollect.png)";
							elem.style.backgroundSize = "cover";
							thisBtn.querySelector(".trade-foot-control-small-btn-title").innerText = "已收藏";
						}
					},
					error: function(xhr) {
						thisBtn.removeAttribute("data-send");
						ajaxError(xhr);
					}
				});
			};

			function handleCancelCollect(thisBtn) {
				var id = thisBtn.getAttribute("data-list-id");
				var token = plus.storage.getItem("tokenValue");
				var URL = "http://farm.rrzuji.com/v1/collect/delete?" + fnCreateSign() + "&access-token=" + token + "&id=" + id;
				mui.ajax(URL, {
					type: "POST",
					dataType: "JSON",
					success: function(res) {
						console.log(res);
						res = JSON.parse(res);
						if (res.success) {
							console.log("取消收藏成功");
							thisBtn.removeAttribute("data-send");
							thisBtn.setAttribute("data-isCollect", "false");
							var elem = thisBtn.querySelector(".trade-foot-control-small-btn-logo");
							elem.style.background = "url(../img/collect.png)";
							elem.style.backgroundSize = "cover";
							thisBtn.querySelector(".trade-foot-control-small-btn-title").innerText = "收藏";
						}
					},
					error: function(xhr) {
						thisBtn.removeAttribute("data-send");
						ajaxError(xhr);
					}
				});
			};
			// 打开购物车 
			document.querySelector(".header-control-right-btn").addEventListener("tap", function() {
				if (NetWorkStatus()) {
					return;
				}
				if (!userLoginStatus()) {
					openLogin(this, true);
					return;
				}
				fnLoadPage(this, {
					url: "../secondlv/webview-my-shopcar.html",
					top: 98,
					bottom: 0
				}, {
					title: "购物车",
					rightBtn: "<span class='header-control-right-btn-span' ></span>"
				});
			});
			// 下方添加到购物车按钮，添加到购物车
			document.getElementById("btnAdd").addEventListener("tap", function(e) {
				if (NetWorkStatus()) {
					return;
				}
				if (!userLoginStatus()) {
					openLogin(this, true);
					return;
				}
				var elem = document.querySelector(".buyDiv-items-active");
				var thisBtn = e.currentTarget;
				if (!elem) {
					mui.toast("请选择套餐");
					return;
				}
				if (parseInt(elem.getAttribute("data-residue") <= 0)) {
					return;
				}
				if (thisBtn.getAttribute("data-send")) {
					return;
				}
				thisBtn.setAttribute("data-send", "true");
				var userId = plus.storage.getItem("userID");
				var standardId = elem.getAttribute("data-itemID");
				var standardName = elem.innerText;
				var itemNums = document.querySelector(".num-choice-mid").innerText;
				console.log(standardId);
				console.log(standardName);
				console.log(itemNums);
				var token = plus.storage.getItem("tokenValue");
				var URL = "http://farm.rrzuji.com/v1/cart/create?" + fnCreateSign() + "&access-token=" + token;
				mui.ajax(URL, {
					type: "POST",
					dataType: "JSON",
					data: {
						user_id: userId,
						shop_id: shopId,
						shop_name: shopName,
						item_id: item_id,
						item_nums: itemNums,
						item_standard_id: standardId,
						item_standard_name: standardName
					},
					success: function(res) {
						console.log("购物车商品添加成功" + res);
						res = JSON.parse(res);
						if (res.success) {
							mui.toast("商品已添加到购物车~");
							// 关闭弹出层
							fnCloseShade("#buyDiv");
						}
						thisBtn.removeAttribute("data-send");
					},
					error: function(xhr) {
						thisBtn.removeAttribute("data-send");
						ajaxError(xhr);
					}
				});
			});
			// 点击下方窗口的完成按钮，然后生成订单
			document.getElementById("btnBuy").addEventListener("tap", function() {
				// 需要传递给订单页
				// 商铺名shopName，商铺图shopImg  获取数据时获得
				// 商品图地址itemImg，商品名itemName 获取数据时获得 
				// 套餐standardName，单价itemPrice，数量itemNums
				if (!userLoginStatus()) {
					openLogin(this, true);
					return;
				}
				var elem = document.querySelector(".buyDiv-items-active");
				if (!elem) {
					mui.toast("请选择套餐");
					return;
				}
				//				if (elem.getAttribute("data-residue") == '' || elem.getAttribute("data-residue") == null) {
				//					return;
				//				}
				if (parseInt(elem.getAttribute("data-residue") <= 0)) {
					return;
				}
				var itemPrice = elem.getAttribute("data-price");
				var standardName = elem.innerText;
				var itemNums = document.querySelector(".num-choice-mid").innerText;
				var standardId = elem.getAttribute("data-itemID");
				console.log("表单数据\n" + shopName + "\n" + shopImg + "\n" + itemImg + "\n" + itemName + "\n" + standardName + "\n" + itemPrice + "\n" + itemNums);
				mui.openWindow({
					url: "webview-trade-order.html",
					id: "webview-trade-order.html",
					styles: fnSetSubpageStyle(0, 0),
					createNew: false,
					extras: {
						data: {
							isShopCar: false,
							allCount: itemNums * itemPrice,
							allNum: itemNums,
							shopItems: [{
								shopImg: shopImg,
								shopName: shopName,
								items: [{
									itemImg: itemImg,
									itemName: itemName,
									standardName: standardName,
									itemPrice: itemPrice,
									itemNums: itemNums
								}]
							}],
							dataPost: {
								shop_id: shopId,
								shop_name: shopName,
								item_id: item_id,
								standard_id: standardId,
								item_num: itemNums
							}
						}
					},
					show: {
						autoShow: true,
						aniShow: "pop-in",
						duration: 300
					},
					waiting: {
						autoShow: true
					}
				});
			});
			window.addEventListener("alertOrderMsg", function() {
				fnCloseShade("#buyDiv");
				mui.toast("提交订单成功!");
			});
			// 联系客服，打开电话界面
			document.querySelector("#contactSale").addEventListener("tap", function() {
				plus.nativeUI.confirm("客服电话：0592-6313811 \n", function(e) {
					if (e.index == 0) {
						plus.device.dial("05926313811");
					}
				}, "联系客服", ["拨打", "取消"]);
			});
			mui.plusReady(function() {
				item_id = plus.webview.currentWebview().itemID
					// 添加tab切换监听
				initSwitchTab();
				// 触发第一个tab 切换事件
				mui.trigger(document.getElementById('initScroll'), "tap");
			});
		</script>
	</body>

</html>